<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>اختيار اللغة</title>
    <link rel="stylesheet" href="assets/styles.css" />
  </head>
  <body>
    <div class="container">
      <h2>اختبار الكفايات اللغوية</h2>
      <p>اختر اللغة للبدء:</p>
      <div style="display: flex; gap: 10px; justify-content: center">
        <button id="arabic" class="btn">ابدأ بالعربية</button>
        <button id="english" class="btn">ابدأ بالإنجليزية</button>
      </div>
      <p id="status" style="color: green; margin-top: 10px"></p>
    </div>

    <script>
      function getProgress() {
        return JSON.parse(localStorage.getItem("exam_progress") || "{}");
      }
      function saveProgress(p) {
        localStorage.setItem("exam_progress", JSON.stringify(p));
      }

      const arBtn = document.getElementById("arabic");
      const enBtn = document.getElementById("english");
      const status = document.getElementById("status");
      const prog = getProgress();

      if (prog.language_ar) {
        arBtn.disabled = true;
        arBtn.classList.add("btn-disabled");
      }
      if (prog.language_en) {
        enBtn.disabled = true;
        enBtn.classList.add("btn-disabled");
      }
      if (prog.language_ar && prog.language_en) {
        status.textContent = "تم الانتهاء من اختبار اللغة، سيتم الرجوع للمحاور";
        setTimeout(() => (window.location.href = "sections.html"), 1500);
      }

      arBtn.addEventListener(
        "click",
        () => (window.location.href = "quiz.html?section=1&lang=ar")
      );
      enBtn.addEventListener(
        "click",
        () => (window.location.href = "quiz.html?section=1&lang=en")
      );

      // If both completed, redirect to break for next axis (knowledge, section 2)
      if (prog.language_ar && prog.language_en) {
        window.location.href = "break.html?next=2";
      }
    </script>
  </body>
</html>
